[å›æº¯ç®—æ³•è§£é¢˜å¥—è·¯æ¡†æ¶ :: labuladongçš„ç®—æ³•å°æŠ„](https://labuladong.github.io/algo/di-san-zha-24031/bao-li-sou-96f79/hui-su-sua-c26da/)

å›æº¯é—®é¢˜è§£æ³•ï¼š
```python
result = []
def backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨):
    if æ»¡è¶³ç»“æŸæ¡ä»¶:
        result.add(è·¯å¾„)
        return
    
    for é€‰æ‹© in é€‰æ‹©åˆ—è¡¨:
        åšé€‰æ‹©
        backtrack(è·¯å¾„, é€‰æ‹©åˆ—è¡¨)
        æ’¤é”€é€‰æ‹©

```
##### å…¨æ’åˆ—ç®—æ³•

###### é—®é¢˜1
![[Pasted image 20230328140940.png]]
```python
classÂ Solution:
Â Â Â Â defÂ permute(self,Â nums:Â List[int])Â ->Â List[List[int]]:
Â Â Â Â Â Â Â Â resÂ =Â []
Â Â Â Â Â Â Â Â defÂ backtrace(nums,Â path,Â decide):
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ len(decide)Â ==Â len(nums):
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ansÂ =Â path.copy()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â res.append(ans)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â forÂ iÂ inÂ nums:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ iÂ inÂ decide:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â continue
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â else:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â path.append(i)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â decide.append(i)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â backtrace(nums,Â path,Â decide)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â path.pop()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â decide.pop()

Â Â Â Â Â Â Â Â pathÂ =Â []
Â Â Â Â Â Â Â Â decideÂ =Â []
Â Â Â Â Â Â Â Â backtrace(nums,Â path,Â decide)
Â Â Â Â Â Â Â Â returnÂ res
```
å…¶ä¸­pathå¯¹åº”æ¨¡æ¿ä¸­çš„è·¯å¾„ï¼Œdecideå¯¹åº”é€‰æ‹©åˆ—è¡¨ï¼Œæ³¨æ„å¯¹äºdecideçš„å¤„ç†æœ‰ä¸¤ç§ï¼š
1.æ­£å‘æ·»åŠ å…ƒç´ çš„decideï¼šåˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é‡Œé¢ï¼Œå¦‚æœåœ¨é‡Œé¢é‚£ä¹ˆå°±ä¸æ·»åŠ å³contimue
2.åå‘åˆ é™¤å…ƒç´ çš„decideï¼šå…ƒç´ ä»decideé‡Œé¢é€‰æ‹©ï¼Œåšå®Œé€‰æ‹©ååˆ é™¤åšé€‰æ‹©çš„é‚£ä¸ªå…ƒç´ ï¼Œå¯¹åº”pythonè¯­æ³•ä¸­çš„remove()

è¾¨æï¼šremoveï¼Œdelï¼Œpop
**1.remove: åˆ é™¤å•ä¸ªå…ƒç´ ï¼Œåˆ é™¤é¦–ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼ŒæŒ‰å€¼åˆ é™¤**
**2.pop: åˆ é™¤å•ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼ŒæŒ‰ä½åˆ é™¤(æ ¹æ®ç´¢å¼•åˆ é™¤)**
**3.delï¼šå®ƒæ˜¯æ ¹æ®ç´¢å¼•(å…ƒç´ æ‰€åœ¨ä½ç½®)æ¥åˆ é™¤**

##### ç»„åˆç®—æ³•
###### é—®é¢˜1
![[Pasted image 20230328141815.png]]
å…ˆåˆ†æï¼Œå°±æ˜¯ç¡®å®špathå’Œdecideä»¥åŠä¸­æ­¢æ¡ä»¶
è¿™é‡Œpathå¾ˆæ˜ç¡®å°±æ˜¯æœ€åçš„ç­”æ¡ˆï¼Œdecideï¼ˆé€‰æ‹©åˆ—è¡¨ï¼‰å°±æ˜¯1åˆ°næ‰€æœ‰çš„æ•°å­—ï¼Œç»ˆæ­¢æ¡ä»¶å°±æ˜¯lenï¼ˆpathï¼‰== k
é‚£ä¹ˆå†™å‡ºä»£ç å°±å¾ˆå®¹æ˜“äº†
è™½ç„¶çœ‹èµ·æ¥å¾ˆå®¹æ˜“ä½†æ˜¯å‡ºé”™äº†å¥½å‡ æ¬¡
ç¬¬ä¸€æ¬¡é”™è¯¯çš„å†™æ³•æ˜¯ï¼š
```python
classÂ Solution:
Â Â Â Â defÂ combine(self,Â n:Â int,Â k:Â int)Â ->Â List[List[int]]:
Â Â Â Â Â Â Â Â resÂ =Â []
Â Â Â Â Â Â Â Â defÂ backtrace(n,Â k,Â path,Â decide):
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ len(path)Â ==Â k:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ansÂ =Â path[:]
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â res.append(ans)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ 
Â Â Â Â Â Â Â Â Â Â Â Â else:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ iÂ inÂ range(1,n+1):
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ iÂ inÂ decide:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â continue
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â path.append(i)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â backtrace(n-1,k,path,decide)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â path.pop()
Â Â Â Â Â Â Â Â backtrace(n,k,[],[])
Â Â Â Â Â Â Â Â returnÂ res
```
å¯¼è‡´ç»“æœä¸ºï¼š
![[Pasted image 20230328145723.png]]

ç¬¬äºŒæ¬¡çš„é”™è¯¯æ˜¯ï¼š
```python
classÂ Solution:
Â Â Â Â defÂ combine(self,Â n:Â int,Â k:Â int)Â ->Â List[List[int]]:
Â Â Â Â Â Â Â Â resÂ =Â []
Â Â Â Â Â Â Â Â defÂ backtrace(n,Â k,Â path,l):
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ len(path)Â ==Â k:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ansÂ =Â path[:]
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â res.append(ans)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ 
Â Â Â Â Â Â Â Â Â Â Â Â forÂ iÂ inÂ range(l,n+1):
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â path.append(i)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â backtrace(n,k,path,l+1)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â path.pop()
Â Â Â Â Â Â Â Â backtrace(n,k,[],1)
Â Â Â Â Â Â Â Â returnÂ res
```
è¿™é‡Œbacktrace(n,k,path,l+1)é”™äº†åº”è¯¥æ˜¯backtrace(n,k,path,i+1)
å¯¼è‡´ç»“æœæ˜¯
![[Pasted image 20230328150101.png]]
æ ‘æ— æ³•æ·±å…¥æ‰©å±•

æ­£ç¡®çš„ä»£ç åº”è¯¥æ˜¯
```python
classÂ Solution:
Â Â Â Â defÂ combine(self,Â n:Â int,Â k:Â int)Â ->Â List[List[int]]:
Â Â Â Â Â Â Â Â resÂ =Â []
Â Â Â Â Â Â Â Â defÂ backtrace(n,Â k,Â path,l):
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ len(path)Â ==Â k:
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ansÂ =Â path[:]
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â res.append(ans)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ 
Â Â Â Â Â Â Â Â Â Â Â Â forÂ iÂ inÂ range(l,n+1):
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â path.append(i)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â backtrace(n,k,path,i+1)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â # æ„æ€æ˜¯åé¢çš„é€‰æ‹©åˆ—è¡¨æ˜¯å·²ç»é€‰å¥½çš„æ•°å­—ä»¥å¤–çš„æ•°
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â path.pop()
Â Â Â Â Â Â Â Â backtrace(n,k,[],1)
Â Â Â Â Â Â Â Â returnÂ res
```

##### æ‹¬å·é—®é¢˜
![[Pasted image 20230328193359.png]]
å¯¹åº”è¿™ä¸ªæ‹¬å·é—®é¢˜é¦–å…ˆè¯†åˆ«å‡ºï¼Œåƒè¿™ç§è®©ä½ ç»™å‡ºæ‰€æœ‰å¯èƒ½ç»„åˆçš„ä¸€èˆ¬éƒ½æ˜¯å›æº¯é—®é¢˜
ç„¶åè¯†åˆ«å‡ºæ¥ä¹‹åå°±è¦æƒ³ pathæ˜¯ä»€ä¹ˆï¼Œdecideæ˜¯ä»€ä¹ˆï¼Œå…¶ä¸­æœ€ä¸»è¦çš„æ˜¯çœ‹å‡ºæ¥decideæ˜¯ä»€ä¹ˆ
é¦–å…ˆå›æº¯é—®é¢˜çš„è§£å†³æ–¹æ³•æ˜¯ï¼š
```python
result = []
def backtrace(param, path, decide):
	if (æ»¡è¶³ä¸­æ­¢æ¡ä»¶):
		return
	for i in decide:
		pathé‡Œæ·»åŠ é€‰æ‹©(path.append or path += i)
		ä½¿è¿™é¡¹é€‰æ‹©å¤±æ•ˆ æˆä¸ºæ–°çš„decide
		backtrace(param, path, decide)
		pathé‡Œç§»é™¤é€‰æ‹©
		decideé‡Œæ˜¯å¦éœ€è¦ç§»é™¤é€‰æ‹©çœ‹æƒ…å†µ
```

é‚£ä¹ˆå¯¹äºç”Ÿæˆæ‹¬å·çš„é—®é¢˜ï¼Œæœ‰ä¸¤ç§çœ‹çš„æ–¹å¼ï¼Œå¯ä»¥çœ‹ä½œæ˜¯åœ¨2nä½ç½®ä¸Šé€‰æ‹©æ˜¯å¦æ”¾ä¸œè¥¿ï¼Œä¹Ÿå¯ä»¥çœ‹ä½œè·¯å¾„ä¸Šæ·»åŠ æ‹¬å·
â‘ å¦‚æœçœ‹ä½œæ˜¯2nä¸ªä½ç½®ä¸Šæ”¾æ‹¬å·ï¼Œé‚£ä¹ˆdecideåº”è¯¥æ˜¯1åˆ°2nçš„æ•°å­—ï¼Œæ¥é€‰æ‹©ä½ç½®ï¼Œâ‘¡å¦‚æœæ˜¯è·¯å¾„ä¸Šæ·»åŠ æ‹¬å·ï¼Œé‚£ä¹ˆé€‰æ‹©æ‹¬å·ä½œä¸ºé€‰æ‹©åˆ—è¡¨

å¯¹â‘ ï¼š
```python
def backtrace(n, path, start):
	if len(path) == 2*n:
		res.appen(path[:])
		return  
	for i in range(start, 2*n):
		path += '('
		backtrace(n, path, i+1)
		path = path[:-1]

		path+=')'
		backtrace(n, path, i+1)
		path = path[:-1]
```

å¯¹â‘¡ï¼š
```python
def backtrace(n, path, idx):
	if len(path) == 2*n:
		res.append(path[:])
		return
		
	forÂ iÂ inÂ ['(',')']:
		pathÂ =Â path+i
		backtrace(n,Â idx+1,Â path)
		pathÂ =Â path[:-1]
		
```

ç„¶ååªéœ€è¦æ£€æŸ¥æ•´ä¸ªæ‹¬å·çš„åˆæ³•æ€§å°±å¯ä»¥äº†
å¥½çš„æ‹¬å·è§£æ³•
```python
# æ³¨æ„ï¼špython ä»£ç ç”± chatGPTğŸ¤– æ ¹æ®æˆ‘çš„ cpp ä»£ç ç¿»è¯‘ï¼Œæ—¨åœ¨å¸®åŠ©ä¸åŒèƒŒæ™¯çš„è¯»è€…ç†è§£ç®—æ³•é€»è¾‘ã€‚
# æœ¬ä»£ç è¿˜æœªç»è¿‡åŠ›æ‰£æµ‹è¯•ï¼Œä»…ä¾›å‚è€ƒï¼Œå¦‚æœ‰ç–‘æƒ‘ï¼Œå¯ä»¥å‚ç…§æˆ‘å†™çš„ cpp ä»£ç å¯¹æ¯”æŸ¥çœ‹ã€‚

from typing import List

def generateParenthesis(n: int) -> List[str]:
    if n == 0:
        return []
    # è®°å½•æ‰€æœ‰åˆæ³•çš„æ‹¬å·ç»„åˆ
    res = []
    # å›æº¯è¿‡ç¨‹ä¸­çš„è·¯å¾„
    track = ""
    # å¯ç”¨çš„å·¦æ‹¬å·å’Œå³æ‹¬å·æ•°é‡åˆå§‹åŒ–ä¸º n
    backtrack(n, n, track, res)
    return res

# å¯ç”¨çš„å·¦æ‹¬å·æ•°é‡ä¸º left ä¸ªï¼Œå¯ç”¨çš„å³æ‹¬å·æ•°é‡ä¸º rgiht ä¸ª
def backtrack(left: int, right: int, track: str, res: List[str]):
    # è‹¥å·¦æ‹¬å·å‰©ä¸‹çš„å¤šï¼Œè¯´æ˜ä¸åˆæ³•
    if right < left:
        return
    # æ•°é‡å°äº 0 è‚¯å®šæ˜¯ä¸åˆæ³•çš„
    if left < 0 or right < 0:
        return
    # å½“æ‰€æœ‰æ‹¬å·éƒ½æ°å¥½ç”¨å®Œæ—¶ï¼Œå¾—åˆ°ä¸€ä¸ªåˆæ³•çš„æ‹¬å·ç»„åˆ
    if left == 0 and right == 0:
        res.append(track)
        return
    
    # å°è¯•æ”¾ä¸€ä¸ªå·¦æ‹¬å·
    track += "("  # é€‰æ‹©
    backtrack(left - 1, right, track, res)
    track = track[:-1]  # æ’¤æ¶ˆé€‰æ‹©

    # å°è¯•æ”¾ä¸€ä¸ªå³æ‹¬å·
    track += ")"  # é€‰æ‹©
    backtrack(left, right - 1, track, res)
    track = track[:-1]  # æ’¤æ¶ˆé€‰æ‹©

```


##### Nçš‡å
![[Pasted image 20230328233206.png]]

è¿™é‡ŒåŒæ ·çš„æ˜¯å›æº¯é—®é¢˜ï¼Œè¦ææ¸…æ¥špathæ˜¯ä»€ä¹ˆï¼Œè¿™é‡Œçš„pathæ˜¯æŒ‰è¡Œ(row)ä¾æ¬¡å¾€ä¸‹å åŠ æˆçš„ä¸€ä¸ªæ£‹ç›˜ï¼Œé€‰æ‹©åˆ—è¡¨(decide)æ˜¯æ£‹ç›˜çš„æŸä¸€è¡Œçš„æ¯ä¸€åˆ—ï¼Œå¯ä»¥è¿™æ ·æƒ³æ¯ä¸€è¡Œé€‰æ‹©å®Œåï¼Œå†é€‰æ‹©æ”¾åœ¨å“ªä¸€åˆ—ï¼Œè¿™ä¸ªç±»æ¯”æ‹¬å·é—®é¢˜çš„æƒ³æ³•ï¼Œå³2nä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®è¦ä¹ˆæ”¾"("è¦ä¹ˆæ”¾â€)â€œè¿™æ ·æƒ³æ‹¬å·é—®é¢˜æ˜¯2nÃ—2ç»´åº¦çš„ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®å°±æ˜¯nÃ—nç»´åº¦çš„ï¼Œé‚£ä¹ˆæ€è·¯å°±æ¸…æ™°èµ·æ¥äº†ã€‚

Nçš‡åé—®é¢˜åœ¨è¿™é‡Œå…³é”®æ˜¯æ‰¾åˆ°for i in ä»€ä¹ˆï¼Œé€‰æ‹©åˆ—è¡¨åº”è¯¥æ˜¯æŸä¸€è¡Œçš„è¿™äº›åˆ—ã€‚

```python
defÂ backtrace(n,Â board,Â row):

	ifÂ rowÂ ==Â n:
		ansÂ =Â [''.join(i[:])Â forÂ iÂ inÂ board]
		res.append(ans)
		returnÂ 
		
	forÂ iÂ inÂ range(n):
		ifÂ isValid(board,Â rowÂ ,i)Â ==Â False:
			continue
		board[row][i]Â =Â 'Q'
		backtrace(n,board,row+1)
		board[row][i]Â =Â '.'
```
ä»¥ä¸Šå°±æ˜¯å…«çš‡åæœ€å…³é”®çš„ä¸€æ­¥